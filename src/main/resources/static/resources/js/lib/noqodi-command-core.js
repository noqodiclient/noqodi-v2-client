!function(e){var n={};function t(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(a,o,function(n){return e[n]}.bind(null,o));return a},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,n){return!n||"object"!==a(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&s(e,n)}function s(e,n){return(s=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function u(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function c(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,n,t){return n&&c(e.prototype,n),t&&c(e,t),e}t.r(n);var m=function(){function e(n,t,a){u(this,e),this.commandViewManager=n,this.commandGroups=t,this.commandHeaderText=a,this.setup()}return d(e,[{key:"setup",value:function(){var n=this;$(".command-nav-link").off().on("click",function(t){var a=contextPath?contextPath+"/web/commands":"/web/commands";if(window.location.pathname===a){t.preventDefault();var o=$(this)[0].id;if(!n.commandGroups[o])return void alert("work in progress... \nbut hey, you can try implementing it yourself... \n - simply clone the git repo... \n - and check out our online documentation...");e.toggleActiveCommandGroupLink($(this)),n.commandViewManager.hideView(),n.updateCommandGroupHeaderTest(o),n.activateCommandGroupById(o)}})}},{key:"updateCommandGroupHeaderTest",value:function(e,n){var t=$("#api-group-header-text");t.fadeOut("fast",function(){var a="Explore noqodi "+("<sppan class='text-danger'>"+this.commandHeaderText[e]+"</sppan>")+" API";t.html(a),t.fadeIn("slow",n)}.bind(this))}},{key:"activateCommandGroupById",value:function(e){var n=this.commandGroups[e],t=n.setup();this.updateCommandGroupHeaderTest(t,function(){n.commandGroupContainerDiv.siblings(".commands-container").hide(),n.commandGroupContainerDiv.fadeIn(1500)})}}],[{key:"toggleActiveCommandGroupLink",value:function(e){var n=e[0].id;e.addClass("active"),$("#"+n).siblings(".command-nav-link").removeClass("active")}}]),e}(),l=function(){function e(){u(this,e),e.styleStart='<span class="text-danger font-weight-normal rounded px-1" style="background: #fdfde9;">',e.styleEnd="</span>",$("#balance-commands-div-carousel").on("slide.bs.carousel",function(){this.hideView()}.bind(this)),this.commandResponseJsonView=$("#command-response-json-view"),this.commandRequestJsonView=$("#command-request-json-view"),this.commandRequestText=$("#command-request-text"),this.commandResponseText=$("#command-response-text"),this.commandHttpMethodText=$("#command-http-method-text"),this.commandHttpUrlText=$("#command-http-url-text"),this.commandHttpStatusText=$("#command-http-status-text"),this.commandHeaderText=$("#command-response-header-text"),this.commandResultComponent=$("#command-result-component-div")}return d(e,[{key:"hideView",value:function(){this.unPpretify(),this.toggleView("hide"),D.scrollTop($("html, body"))}},{key:"showView",value:function(e,n){setTimeout(function(){this.updateCommandResponseView(e),this.pretify(),this.toggleView("show"),D.scrollTop(this.commandResultComponent,n)}.bind(this),400)}},{key:"toggleView",value:function(e){this.commandResultComponent.collapse(e)}},{key:"pretify",value:function(){PR.prettyPrint()}},{key:"unPpretify",value:function(){this.commandResponseJsonView.removeClass("prettyprinted").removeAttr("style"),this.commandRequestJsonView.removeClass("prettyprinted").removeAttr("style")}},{key:"updateCommandResponseView",value:function(e){e.isJsonRequest?(this.commandRequestText.hide(),this.commandRequestJsonView.show().html(e.request)):(this.commandRequestJsonView.hide(),this.commandRequestText.show().html(e.request)),e.isJsonResponse?(this.commandResponseText.hide(),this.commandResponseJsonView.show().html(e.response)):(this.commandResponseJsonView.hide(),this.commandResponseText.show().html(e.response)),this.commandHttpMethodText.text(e.httpMethod),this.commandHttpUrlText.html(e.requestUrl),this.commandHttpStatusText.text(e.httpStatus),this.commandHeaderText.text(e.headerText)}}],[{key:"disableExecuteCommandButton",value:function(n){n&&e.toggleExecuteCommandButton(n,!0)}},{key:"enableExecuteCommandButton",value:function(n){n&&setTimeout(function(){e.toggleExecuteCommandButton(n,!1)},1e3)}},{key:"toggleExecuteCommandButton",value:function(e,n){e&&e.attr("disabled",n)}}]),e}(),p=function(){function e(n){u(this,e),this.commands=n,this.commandHeaderTextId="balances-command-nav-link",this.commandGroupContainerDiv=$("#balance-commands-container")}return d(e,[{key:"setup",value:function(){return this.initMerchantOperation(),this.initMerchantBeneOperation(),this.initCustomerWalletOperation(),this.commandHeaderTextId}},{key:"initMerchantOperation",value:function(){$("#balance-merchant-command-button").off().on("click",function(n){e.doCommonRoutine(n),this.commands.merchantBalanceCommand.execute()}.bind(this))}},{key:"initMerchantBeneOperation",value:function(){$("#balance-merchant-beneficiaries-command-button").off().on("click",function(n){e.doCommonRoutine(n),this.commands.merchantBalanceBeneficiariesCommand.execute(null,null,"/BALANCE")}.bind(this))}},{key:"initCustomerWalletOperation",value:function(){$("#balance-customer-wallet-command-button").off().on("click",function(n){e.doCommonRoutine(n),this.commands.customerWalletBalanceCommand.execute()}.bind(this))}}],[{key:"doCommonRoutine",value:function(e){e.preventDefault()}}]),e}(),f=function(){function e(){u(this,e),this.commandHeaderTextId="payments-command-nav-link",this.commandGroupContainerDiv=$("#payment-commands-container")}return d(e,[{key:"setup",value:function(){return this.commandHeaderTextId}}]),e}(),h=function(){function e(n,t){u(this,e),this.commands=n,this.commandHeaderTextId="refunds-command-nav-link",this.commandGroupContainerDiv=$("#refunds-commands-container"),this.commandViewManager=t}return d(e,[{key:"setup",value:function(){var e=this;return $("#refund-nav-pills").off("shown.bs.tab").on("shown.bs.tab",function(n){switch(e.commandViewManager.hideView(),n.target.id){case"nav-new-refund-tab":e.initNewRefundOperation();break;case"nav-complete-refund-tab":e.initCompleteRefundOperation();break;case"nav-refund-inquiry-tab":e.initRefundInquiryOperation()}}),this.initNewRefundOperation(),this.initCompleteRefundOperation(),this.initRefundInquiryOperation(),this.commandHeaderTextId}},{key:"initNewRefundOperation",value:function(){$("#new-refund-items-feedback").hide();var e=M.getCapturedPayments(),n=M.getRefundedPayments(),t=e.filter(function(e){return!n.some(function(n){return e.merchantInfo.merchantOrderId===n.merchantInfo.merchantOrderId})});t&&0!==t.length||($("#new-refund-items-feedback").show(),t=[]);var a=this;y.commandSetup(!0,function(e){a.commands.newRefundCommand.execute(e)},t,"#non-refunded-payment-list","refund","-new-refund")}},{key:"initCompleteRefundOperation",value:function(){$("#complete-refund-items-feedback").hide();var e=M.getCapturedPayments();e&&0!==e.length||($("#complete-refund-items-feedback").show(),e=[]);var n=this;y.commandSetup(!0,function(e){var t={serviceType:"REFUND",merchantInfo:{merchantCode:e.merchantInfo.merchantCode,merchantRequestId:e.merchantInfo.merchantRequestId,merchantOrderId:e.merchantInfo.merchantOrderId}};n.commands.completeRefundCommand.execute(t)},e,"#maybe-refunded-payment-list","complete refund","-complete-refund")}},{key:"initRefundInquiryOperation",value:function(){$("#refund-inquiry-items-feedback").hide();var e=M.getRefundedPayments();e&&0!==e.length||($("#refund-inquiry-items-feedback").show(),e=[]);var n=this;y.commandSetup(!0,function(e){n.commands.refundInquiryCommand.execute(null,null,"/"+e.id)},e,"#definitely-refunded-payment-list","refund inquiry","-refund-inquiry")}}],[{key:"doCommonRoutine",value:function(e){e.preventDefault()}}]),e}(),y=function(){function e(){u(this,e)}return d(e,null,[{key:"getPaidOutTransactionDate",value:function(n){return e.getTransactionDate(n,M.getPayouts())}},{key:"getCapturedTransactionDate",value:function(n){return e.getTransactionDate(n,M.getCapturedPayments())}},{key:"getTransactionDate",value:function(e,n){var t=n.find(function(n){return n.merchantInfo.merchantOrderId===e});return t?t.paymentInfo.transactionDate:"N/A"}},{key:"commandSetup",value:function(n,t,a,o,i,r){$(o).empty(),a.forEach(function(a,s){var u=a.merchantInfo.merchantOrderId,c=$("<tr></tr>"),d=$("<th scope='row'></th>").text(s+1),m=$("<td></td>"),p=$("<div class='card border-0 p-0 m-0'></div>").css({width:"100%"}),f=$("<div class='card-body text-muted p-0 m-0'></div>").css({"font-size":"16px"}),y=$("<div class='card-text'></div>"),v=$("<p class='p-0 m-0'>Transaction Amount: </p>"),b=$("<span class='text-danger'>"+a.paymentInfo.amount.currency+" "+a.paymentInfo.amount.value+"</span>"),w=$("<p class='p-0 m-0'>Transaction Date: </p>"),g=n?e.getCapturedTransactionDate(u):e.getPaidOutTransactionDate(u),C=$("<span class='text-danger'>"+g+"</span>"),k=$("<p class='p-0 m-0'>Merchant Order ID: </p>"),A=$("<span class='text-danger'>"+u+"</span>"),x=$("<div class='my-2'></div>"),T=$("<button class='btn btn-muted'>"+i+"</button>").attr({id:a.merchantInfo.merchantOrderId+r,class:"btn btn-muted"}),R=$("<span></span>");T.off().on("click",function(){H.currentCommandButtonReference=T,H.currentCommandStatusReference=R,l.disableExecuteCommandButton(T),h.doCommonRoutine(event),t(a)}),v.append(b),w.append(C),k.append(A),x.append(T).append("&nbsp;&nbsp;").append(R),y.append(v).append(w).append(k).append(x),f.append(y),p.append(f),m.append(p),c.append(d).append(m),$(o).append(c)})}}]),e}(),v={beneficiaryOneAmount:3599.99,beneficiaryTwoAmount:1999.99},b={beneficiaryOnePayoutAmount:0,beneficiaryTwoPayoutAmount:0,beneficiaryOneBalance:0,beneficiaryTwoBalance:0},w=function(){function e(n,t,a){u(this,e),this.commands=n,this.commandViewManager=t,this.commandHeaderTextId="payouts-command-nav-link",this.commandGroupContainerDiv=$("#payouts-commands-container"),this.beneficiaryBalanceCommandForPayout=a}return d(e,[{key:"setup",value:function(){var e=this;return $("#payout-nav-pills").off("shown.bs.tab").on("shown.bs.tab",function(n){switch(e.commandViewManager.hideView(),n.target.id){case"nav-new-payout-tab":e.initNewPayoutOperation(),e.beneficiaryBalanceCommandForPayout.execute(null,null,"/PAYOUT");break;case"nav-payout-details-tab":e.initPayoutDetailsOperation()}}),this.initNewPayoutOperation(),this.initPayoutDetailsOperation(),this.beneficiaryBalanceCommandForPayout.execute(null,null,"/PAYOUT"),g.init(),this.commandHeaderTextId}},{key:"initNewPayoutOperation",value:function(){$("#execute-payout-button").off().on("click",function(n){e.doCommonRoutine(n),$("#bene-one-previous-balance-div").show(),$("#bene-one-previous-payout-amount-div").show(),$("#bene-two-previous-balance-div").show(),$("#bene-two-previous-payout-amount-div").show(),$("#prevoius-payout-total-label").show(),$("#prevoius-payout-total-text").show(),$("#bene-one-previous-balance").text("AED "+b.beneficiaryOneBalance),$("#bene-one-previous-payout-amount").text("AED "+v.beneficiaryOneAmount),$("#bene-two-previous-balance").text("AED "+b.beneficiaryTwoBalance),$("#bene-two-previous-payout-amount").text("AED "+v.beneficiaryTwoAmount),$("#prevoius-payout-total-text").text("AED "+(+v.beneficiaryOneAmount+ +v.beneficiaryTwoAmount).toFixed(2)),this.commands.payoutCommand.execute(v)}.bind(this))}},{key:"initPayoutDetailsOperation",value:function(){$("#get-payout-details-items-feedback").hide();var e=M.getPayouts();e&&0!==e.length||($("#get-payout-details-items-feedback").show(),e=[]);var n=this;y.commandSetup(!1,function(e){var t="/"+e.merchantInfo.merchantCode+"/"+e.merchantInfo.merchantOrderId;n.commands.getPayoutDetailsCommand.execute(null,null,t)},e,"#payouts-payment-list","get payout details","-get-payout-details")}}],[{key:"doCommonRoutine",value:function(e){e.preventDefault()}}]),e}(),g=function(){function e(){u(this,e)}return d(e,null,[{key:"init",value:function(){e.initItemEditorPopover(e.itemOneEditButton),e.initItemEditorPopover(e.itemTwoEditButton),e.initItemEditorToggle(),e.initItemEditorActions(e.itemOneEditButton,"beneficiaryOneAmount"),e.initItemEditorActions(e.itemTwoEditButton,"beneficiaryTwoAmount"),e.updateOrderAmount(v.beneficiaryOneAmount,v.beneficiaryTwoAmount)}},{key:"updateItemAmount",value:function(n,t){isNaN(n)||("beneficiaryOneAmount"===t?v.beneficiaryOneAmount=(+n).toFixed(2):"beneficiaryTwoAmount"===t&&(v.beneficiaryTwoAmount=(+n).toFixed(2)),e.updateOrderAmount(v.beneficiaryOneAmount,v.beneficiaryTwoAmount))}},{key:"updateOrderAmount",value:function(e,n){$("#item-1-amount-text").text("AED "+e),$("#item-2-amount-text").text("AED "+n),$("#order-total-text").text("AED "+(+e+ +n).toFixed(2))}},{key:"initItemEditorPopover",value:function(e){e.popover({container:"body",html:!0,placement:"left",title:"Update Amount",trigger:"manual",animation:!1,template:'<div class="popover shadow border-0 amount-editor-popover" role="tooltip">\n    <div class="arrow"></div>\n    <h3 class="popover-header bg-danger text-white"></h3>\n    <div class="popover-body"></div>\n</div>',content:'\n<div class="row px-3">\n    <div class="col-9 m-0 p-0 pr-1">    \n        <div class="input-group my-auto">\n            <div class="input-group-prepend">\n                <span class="input-group-text">AED</span>\n            </div>\n            <input id="order-item-new-amount" type="number" class="form-control input-sm" placeholder="Amount" aria-label="Amount">\n        </div>\n    </div>\n    <div class="col-3 row m-0 p-0 pl-1">\n        <div class="col m-0 p-0 pr-1">\n            <h3 id="update-item-amount-button" class="text-success m-0"><i class="fas fa-check"></i></h3>\n        </div>\n        <div class="col m-0 p-0 pl-1">\n            <h3 id="cancel-update-item-amount-button" class="text-danger m-0"><i class="fas fa-times"></i></h3>\n        </div>\n    </div>\n</div>'})}},{key:"initItemEditorActions",value:function(n,t){n.on("shown.bs.popover",function(){var n=$("#update-item-amount-button"),a=$("#cancel-update-item-amount-button"),o=$("#order-item-new-amount");o.val(e.getCurrentValue(t)),n.off().on("click",function(){e.updateItemAmount(o.val(),t),e.hideAll()}),a.off().on("click",function(){e.hideAll()})})}},{key:"getCurrentValue",value:function(e){return"beneficiaryOneAmount"===e?v.beneficiaryOneAmount:"beneficiaryTwoAmount"===e?v.beneficiaryTwoAmount:0}},{key:"hideAll",value:function(){e.itemOneEditButton.popover("hide"),e.itemTwoEditButton.popover("hide")}},{key:"initItemEditorToggle",value:function(){e.itemOneEditButton.off().on("click",function(){e.editDisabled||e.itemOneEditButton.popover("toggle")}),e.itemOneEditButton.on("show.bs.popover",function(){e.itemTwoEditButton.popover("hide")}),e.itemTwoEditButton.off().on("click",function(){e.editDisabled||e.itemTwoEditButton.popover("toggle")}),e.itemTwoEditButton.on("show.bs.popover",function(){e.itemOneEditButton.popover("hide")})}},{key:"itemOneEditButton",get:function(){return $("#item-1-amount-edit")}},{key:"itemTwoEditButton",get:function(){return $("#item-2-amount-edit")}},{key:"editDisabled",get:function(){return e._editDisabled},set:function(n){e._editDisabled=n}}]),e}(),C=function(){function e(n,t,a){u(this,e),this.commandViewManager=n,this.commandButton=t,this.customTransformer=a}return d(e,[{key:"preActionHandler",value:function(){l.disableExecuteCommandButton(this.commandButton),this.commandViewManager.hideView()}},{key:"successHandler",value:function(e){var n=this.customTransformer?D.finalizeCommandResult(this.customTransformer(e)):D.finalizeCommandResult(e);this.commandViewManager.showView(n,140),l.enableExecuteCommandButton(this.commandButton)}},{key:"errorHandler",value:function(){l.enableExecuteCommandButton(this.commandButton)}}]),e}(),k=function(){function e(n,t,a){u(this,e),this.preActionHandler=n,this.successHandler=t,this.errorHandler=a}return d(e,[{key:"preActionHandler",value:function(){this.preActionHandler()}},{key:"successHandler",value:function(e){this.successHandler(e)}},{key:"errorHandler",value:function(){this.errorHandler()}}]),e}(),A=function(){function e(n,t,a,o,i,r){u(this,e),this.uri=n,this.type=t,this.commandHandler=a,this.isJsonRequest=o,this.isJsonResponse=i,this.headerText=r+" - API Request/Response"}return d(e,[{key:"execute",value:function(e,n,t){var a=!!n;this.commandHandler.preActionHandler();var o=this,i=P.appBaseUrl+P.apiBasePath+this.uri+(t||""),r=a?"Basic "+btoa(n.username+":"+n.password):"Bearer "+U.getApiAccessToken(),s={xhrFields:{withCredentials:!0},beforeSend:function(e){e.setRequestHeader("Authorization",r)},success:function(e){e.isJsonRequest=o.isJsonRequest,e.isJsonResponse=o.isJsonResponse,e.headerText=o.headerText,o.commandHandler.successHandler(e),a||U.setFailedApiCommandAndOptions(null,null)},error:function(i){if(401===i.status||403===i.status){var r="";if(r=n?"The server is not happy with the credentials you provided...\n- you can either keep guessing...\n- or phone a friend...\n- or as a last resort, ask us nicely...":"Ummm... your session expired many many many centuries ago...\n2000 BC, to be precise...\nplease re-login if you want to stay happy on this site...",alert(r),U.deleteAccessCredentials(),U.showAccessCredentialsForm(),a)return;var s={request:e,pathVariable:t};U.setFailedApiCommandAndOptions(o,s)}else alert("Oops! here goes an undocumented feature :(\nplease tell us about it so we can fix it.");o.commandHandler.errorHandler()},type:o.type,url:i};e&&(s.data=JSON.stringify(e),s.contentType="application/json"),$.ajax(s)}}],[{key:"encode",value:function(e){return e?"/"+encodeURI(e):""}}]),e}(),x=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/token","POST",e,!1,!1,""))}return r(n,A),n}(),T=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/balances/merchant","GET",e,!1,!0,"Merchant Beneficiaries' Balance"))}return r(n,A),n}(),R=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/balances/merchant/beneficiaries","GET",e,!1,!0,"Merchant Beneficiary List Balance"))}return r(n,A),n}(),O=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/balances/customer","GET",e,!1,!0,"Customer Wallet Balance"))}return r(n,A),n}(),B=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/refunds","POST",e,!0,!0,"Refund"))}return r(n,A),n}(),S=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/refunds/complete","POST",e,!0,!0,"Complete Refund"))}return r(n,A),n}(),I=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/refunds","GET",e,!1,!0,"Refund Inquiry"))}return r(n,A),n}(),q=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/payouts","POST",e,!0,!0,"Payout"))}return r(n,A),n}(),E=function(e){function n(e){return u(this,n),o(this,i(n).call(this,"/payouts","GET",e,!1,!0,"Get Payout Details"))}return r(n,A),n}(),P={noqodiPaymentPage:null,noqodiPaymentPageOrigin:null,callbackUrl:null,noqodiReadyData:null,apiBasePath:null,appBaseUrl:null},H={currentCommandButtonReference:{},currentCommandStatusReference:{}},V=function(){function e(){u(this,e)}return d(e,[{key:"noqodiPaymentPage",value:function(e){return e&&(P.noqodiPaymentPage=e),this}},{key:"noqodiPaymentPageOrigin",value:function(e){return e&&(P.noqodiPaymentPageOrigin=e),this}},{key:"callbackUrl",value:function(e){return e&&(P.callbackUrl=e),this}},{key:"noqodiReadyData",value:function(e){return e&&(P.noqodiReadyData=e),this}},{key:"apiBasePath",value:function(e){return e&&(P.apiBasePath=e),this}},{key:"appBaseUrl",value:function(e){return e&&(P.appBaseUrl=e),this}}],[{key:"builder",value:function(){return e.instance?e.instance:e.instance=new e}},{key:"instance",get:function(){return e._instance},set:function(n){e._instance=n}}]),e}(),D=function(){function e(){u(this,e)}return d(e,null,[{key:"bindEvent",value:function(n,t,a){e.unbindEvent(n,t,a),n.addEventListener?n.addEventListener(t,a):n.attachEvent&&n.attachEvent("on"+t,a)}},{key:"unbindEvent",value:function(e,n,t){e.removeEventListener?e.removeEventListener(n,t):e.detachEvent&&e.detachEvent("on"+n,t)}},{key:"toggleTraceElementAnimation",value:function(e,n){n?setTimeout(function(){e.removeClass("animated-trace-element")},1e3):e.removeClass("animated-trace-element").addClass("animated-trace-element")}},{key:"toggleTraceElement",value:function(e,n){e.attr("disabled",!n),e.removeClass(n?"btn-secondary":"btn-outline-success").addClass(n?"btn-outline-success":"btn-secondary")}},{key:"finalizeCommandResult",value:function(n){var t=e.setDefaults(n),a={};return a.request=t.isJsonRequest?e.jsonStringifyOmitNulls(t.request,null,2):t.request,a.response=t.isJsonResponse?e.jsonStringifyOmitNulls(t.response,null,2):t.response,a.httpMethod=t.httpMethod,a.requestUrl=t.requestUrl,a.httpStatus=t.httpStatus,a.isJsonRequest=t.isJsonRequest,a.isJsonResponse=t.isJsonResponse,a.headerText=t.headerText,a}},{key:"setDefaults",value:function(e){var n={};return n.request=e.request?e.request:"N/A",n.response=e.response?e.response:"N/A",n.httpMethod=e.httpMethod?e.httpMethod:"N/A",n.requestUrl=e.requestUrl?e.requestUrl:"N/A",n.httpStatus=e.httpStatus?e.httpStatus:"N/A",n.isJsonRequest=e.isJsonRequest,n.isJsonResponse=e.isJsonResponse,n.headerText=e.headerText?e.headerText:"N/A",n}},{key:"jsonStringifyOmitNulls",value:function(e){return JSON.stringify(e,function(e,n){if(null!==n)return n},2)}},{key:"uuidv4",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}},{key:"scrollTop",value:function(e,n){$("html, body").animate({scrollTop:e.offset().top-(n||0)},500)}},{key:"isCommandResponseSuccess",value:function(e){return e.response&&e.response.statusInfo&&e.response.statusInfo.status&&"SUCCESS"===e.response.statusInfo.status}}]),e}(),M=function(){function e(){u(this,e)}return d(e,null,[{key:"setup",value:function(){e.payments={authorized:[],captured:[],voided:[],refunded:[],payouts:[]},e.loadFromStorage()}},{key:"addAuthorizedPayment",value:function(n){e.payments.authorized.push(n),e.updateToStorage()}},{key:"addCapturedPayment",value:function(n){e.payments.captured.push(n),e.updateToStorage()}},{key:"addVoidedPayment",value:function(n){e.payments.voided.push(n),e.updateToStorage()}},{key:"addRefundedPayment",value:function(n){e.payments.refunded.some(function(e){return e.merchantInfo.merchantOrderId===n.merchantInfo.merchantOrderId})||(e.payments.refunded.push(n),e.updateToStorage())}},{key:"addRPayouts",value:function(n){e.payments.payouts.push(n),e.updateToStorage()}},{key:"loadFromStorage",value:function(){if(window.sessionStorage&&sessionStorage.payments){var n=JSON.parse(sessionStorage.payments);e.payments.authorized=n.authorized?n.authorized:[],e.payments.captured=n.captured?n.captured:[],e.payments.voided=n.voided?n.voided:[],e.payments.refunded=n.refunded?n.refunded:[],e.payments.payouts=n.payouts?n.payouts:[]}}},{key:"deleteFromStorage",value:function(){window.sessionStorage&&sessionStorage.payments&&sessionStorage.removeItem("payments")}},{key:"updateToStorage",value:function(){window.sessionStorage&&(sessionStorage.payments=JSON.stringify(e.payments))}},{key:"getAuthorizedPayments",value:function(){return e.payments.authorized}},{key:"getCapturedPayments",value:function(){return e.payments.captured}},{key:"getVoidedPayments",value:function(){return e.payments.voided}},{key:"getRefundedPayments",value:function(){return e.payments.refunded}},{key:"getPayouts",value:function(){return e.payments.payouts}}]),e}(),U=function(){function e(){u(this,e)}return d(e,null,[{key:"setFailedApiCommandAndOptions",value:function(n,t){e._failedApiCommand=n,e._failedApiCommandOptions=t}},{key:"setup",value:function(){setTimeout(function(){window.sessionStorage&&sessionStorage.apiAccessToken?(e.updateAccessCredentials(sessionStorage.apiAccessToken),e.hideAccessCredentialsForm()):e.showAccessCredentialsForm()},1e3),e.accessCredentialsButton.off().on("click",function(){e.executeApiAccessTokenRequest()})}},{key:"executeApiAccessTokenRequest",value:function(){var n=e.usernameInput.val(),t=e.passwordInput.val();if(n&&t){var a={username:n,password:t};e.appApiAccessTokenCommand.execute(null,a)}}},{key:"getApiAccessToken",value:function(){return e.apiAccessToken||e.loadApiAccessTokenFromSession(),e.apiAccessToken}},{key:"loadApiAccessTokenFromSession",value:function(){window.sessionStorage&&sessionStorage.apiAccessToken&&e.updateAccessCredentials(sessionStorage.apiAccessToken)}},{key:"deleteAccessCredentials",value:function(){e.usernameInput.val(""),e.passwordInput.val(""),window.sessionStorage&&sessionStorage.apiAccessToken&&sessionStorage.removeItem("apiAccessToken")}},{key:"updateAccessCredentials",value:function(n){e.apiAccessToken=n}},{key:"hideAccessCredentialsForm",value:function(){e.accessCredentialsWrapper.fadeOut("slow",function(){e.accessCredentialsWrapper.removeClass("d-flex")})}},{key:"showAccessCredentialsForm",value:function(){e.accessCredentialsWrapper.fadeIn("slow",function(){e.accessCredentialsWrapper.addClass("d-flex")})}},{key:"accessCredentialsButton",get:function(){return $("#save-access-credentials-button")}},{key:"usernameInput",get:function(){return $("#access-credentials-username")}},{key:"passwordInput",get:function(){return $("#access-credentials-password")}},{key:"accessCredentialsWrapper",get:function(){return $("#login-page-container")}},{key:"failedApiCommand",get:function(){return e._failedApiCommand}},{key:"failedApiCommandOptions",get:function(){return e._failedApiCommandOptions}},{key:"appApiAccessTokenCommand",get:function(){if(e._appApiAccessTokenCommand)return e._appApiAccessTokenCommand;var n=new k(function(){},function(n){e.updateAccessCredentials(n.access_token),window.sessionStorage&&(sessionStorage.apiAccessToken=n.access_token),e.hideAccessCredentialsForm(),e.failedApiCommand&&e.failedApiCommandOptions&&e.failedApiCommand.execute(e.failedApiCommandOptions.request,null,e.failedApiCommandOptions.pathVariable)},function(){});return e._appApiAccessTokenCommand=new x(n)}}]),e}();function J(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function F(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function N(e,n,t){return n&&F(e.prototype,n),t&&F(e,t),e}t.d(n,"NewRefundCommandHandler",function(){return G}),t.d(n,"CompleteRefundCommandHandler",function(){return j}),t.d(n,"RefundInquiryCommandHandler",function(){return z}),t.d(n,"PayoutCommandHandler",function(){return W}),t.d(n,"GetPayoutDetailsCommandHandler",function(){return L}),t.d(n,"BeneficiaryBalanceCommandHandlerForPayout",function(){return Y});var _='This endpoint does not require a request payload. The required path variable(s) are <span class="text-danger font-weight-normal rounded px-1" style="background: #fdfde9;">highlighted</span> in the URL above',G=function(){function e(n){J(this,e),this.commandViewManager=n}return N(e,[{key:"preActionHandler",value:function(){this.commandViewManager.hideView()}},{key:"successHandler",value:function(e){D.isCommandResponseSuccess(e)?(M.addRefundedPayment(e.response),H.currentCommandStatusReference.html('<span class="text-success">refunded</span>')):(l.enableExecuteCommandButton(H.currentCommandButtonReference),H.currentCommandStatusReference.html('<span class="text-danger">error</span>')),this.commandViewManager.showView(D.finalizeCommandResult(e),140)}},{key:"errorHandler",value:function(){l.enableExecuteCommandButton(H.currentCommandButtonReference),H.currentCommandStatusReference.html('<span class="text-danger">error</span>')}}]),e}(),j=function(){function e(n){J(this,e),this.commandViewManager=n}return N(e,[{key:"preActionHandler",value:function(){this.commandViewManager.hideView()}},{key:"successHandler",value:function(e){D.isCommandResponseSuccess(e)?(M.addRefundedPayment(e.response),H.currentCommandStatusReference.html('<span class="text-success">completed</span>')):(l.enableExecuteCommandButton(H.currentCommandButtonReference),H.currentCommandStatusReference.html('<span class="text-danger">error</span>')),this.commandViewManager.showView(D.finalizeCommandResult(e),140)}},{key:"errorHandler",value:function(){l.enableExecuteCommandButton(H.currentCommandButtonReference),H.currentCommandStatusReference.html('<span class="text-danger">error</span>')}}]),e}(),z=function(){function e(n){J(this,e),this.commandViewManager=n}return N(e,[{key:"preActionHandler",value:function(){this.commandViewManager.hideView()}},{key:"successHandler",value:function(e){D.isCommandResponseSuccess(e)?H.currentCommandStatusReference.html('<span class="text-success">done</span>'):(l.enableExecuteCommandButton(H.currentCommandButtonReference),H.currentCommandStatusReference.html('<span class="text-danger">error</span>'));var n=D.finalizeCommandResult(this.customTransformer(e));this.commandViewManager.showView(n,140)}},{key:"errorHandler",value:function(){l.enableExecuteCommandButton(H.currentCommandButtonReference),H.currentCommandStatusReference.html('<span class="text-danger">error</span>')}},{key:"customTransformer",value:function(e){var n=e.request.noqodiResponseId,t=e.requestUrl.replace(n,l.styleStart+n+l.styleEnd);return e.request=_,e.requestUrl=t,e}}]),e}(),W=function(){function e(n,t,a){J(this,e),this.commandViewManager=n,this.commandButtonId=t,this.beneficiaryBalanceCommandForPayout=a}return N(e,[{key:"preActionHandler",value:function(){l.disableExecuteCommandButton($(this.commandButtonId)),this.commandViewManager.hideView()}},{key:"successHandler",value:function(e){D.isCommandResponseSuccess(e)&&(M.addRPayouts(e.response),this.beneficiaryBalanceCommandForPayout.execute(null,null,"/PAYOUT")),this.commandViewManager.showView(D.finalizeCommandResult(e),140),l.enableExecuteCommandButton($(this.commandButtonId))}},{key:"errorHandler",value:function(){l.enableExecuteCommandButton($(this.commandButtonId))}}]),e}(),L=function(){function e(n,t){J(this,e),this.commandViewManager=n,this.customTransformer=t}return N(e,[{key:"preActionHandler",value:function(){l.disableExecuteCommandButton(H.currentCommandButtonReference),this.commandViewManager.hideView()}},{key:"successHandler",value:function(e){D.isCommandResponseSuccess(e)?H.currentCommandStatusReference.html('<span class="text-success">success</span>'):H.currentCommandStatusReference.html('<span class="text-danger">error</span>');var n=this.customTransformer?D.finalizeCommandResult(this.customTransformer(e)):D.finalizeCommandResult(e);this.commandViewManager.showView(n,140),l.enableExecuteCommandButton(H.currentCommandButtonReference)}},{key:"errorHandler",value:function(){l.enableExecuteCommandButton(H.currentCommandButtonReference),H.currentCommandStatusReference.html('<span class="text-danger">error</span>')}}]),e}(),Y=function(){function e(){J(this,e)}return N(e,[{key:"preActionHandler",value:function(){}},{key:"successHandler",value:function(e){if(D.isCommandResponseSuccess(e)){var n=e.response.merchantInquiryInfo.beneficiaries[0].beneCurrentBalance.toFixed(2),t=e.response.merchantInquiryInfo.beneficiaries[1].beneCurrentBalance.toFixed(2);b.beneficiaryOneBalance=n,b.beneficiaryTwoBalance=t,b.beneficiaryOnePayoutAmount=n,b.beneficiaryTwoPayoutAmount=t;var a=e.response.merchantInquiryInfo.beneficiaries[0].beneficiaryAcctNumber,o=e.response.merchantInquiryInfo.beneficiaries[1].beneficiaryAcctNumber;$("#bene-one-account-number").text(a),$("#bene-one-current-balance").text("AED "+n),g.updateItemAmount(n,"beneficiaryOneAmount"),$("#bene-two-account-number").text(o),$("#bene-two-current-balance").text("AED "+t),g.updateItemAmount(t,"beneficiaryTwoAmount")}}},{key:"errorHandler",value:function(){g.updateItemAmount(0,"beneficiaryOneAmount"),g.updateItemAmount(0,"beneficiaryTwoAmount")}}]),e}();!function(){initConfiguration(V.builder());var e=new l,n=$("#balance-merchant-command-button"),t=$("#balance-merchant-beneficiaries-command-button"),a=$("#balance-customer-wallet-command-button"),o=new C(e,n,function(e){var n=e.request.merchantCode,t=e.requestUrl.replace(n,l.styleStart+n+l.styleEnd);return e.request=_,e.requestUrl=t,e}),i=new C(e,t,function(e){var n=e.request.merchantCode,t=e.request.beneficiaries,a=e.requestUrl.replace(n,l.styleStart+n+l.styleEnd);return a=a.replace(t,l.styleStart+t+l.styleEnd),e.request=_,e.requestUrl=a,e}),r=new C(e,a,function(e){var n=e.request.walletId,t=e.requestUrl.replace(n,l.styleStart+n+l.styleEnd);return e.request=_,e.requestUrl=t,e}),s=new Y,u=new R(s),c=new W(e,"#execute-payout-button",u),d=new L(e,function(e){var n=e.request.merchantCode,t=e.request.merchantOrderId,a=e.requestUrl.replace(n,l.styleStart+n+l.styleEnd);return a=a.replace(t,l.styleStart+t+l.styleEnd),e.request=_,e.requestUrl=a,e}),y={merchantBalanceCommand:new T(o),merchantBalanceBeneficiariesCommand:new R(i),customerWalletBalanceCommand:new O(r)},v={newRefundCommand:new B(new G(e)),completeRefundCommand:new S(new j(e)),refundInquiryCommand:new I(new z(e))},b={payoutCommand:new q(c),getPayoutDetailsCommand:new E(d)},g={"balances-command-nav-link":new p(y),"payments-command-nav-link":new f,"refunds-command-nav-link":new h(v,e),"payouts-command-nav-link":new w(b,e,u)},k=new m(e,g,{"balances-command-nav-link":"Balances","payments-command-nav-link":"Payments","payouts-command-nav-link":"Payouts","refunds-command-nav-link":"Refunds","vouchers-command-nav-link":"Vouchers"});l.enableExecuteCommandButton(n),k.activateCommandGroupById("balances-command-nav-link"),$(document).ready(function(){U.setup(),M.setup()})}()}]);
//# sourceMappingURL=noqodi-command-core.js.map